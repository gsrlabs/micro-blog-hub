#!/bin/bash
# generate-jwt-secret.sh

echo "üîê –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞"
echo "=================================="

# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ 64 –±–∞–π—Ç–∞ –∏ –∫–æ–¥–∏—Ä—É–µ–º –≤ base64
SECRET=$(openssl rand -base64 64 | tr -d '\n' | tr '+/' '-_')

echo "üìã –í–∞—à –Ω–æ–≤—ã–π JWT_SECRET (64 –±–∞–π—Ç–∞, URL-safe Base64):"
echo "=================================================="
echo "$SECRET"
echo "=================================================="
echo "–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤ .env"
echo ""
echo "‚ö†Ô∏è  –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:"
echo "‚Ä¢ –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —ç—Ç–æ—Ç –∫–ª—é—á –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ"
echo "‚Ä¢ –ù–ò–ö–û–ì–î–ê –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ –µ–≥–æ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π"


# –°–æ–∑–¥–∞–µ–º .env —Ñ–∞–π–ª —Å –∫–ª—é—á–æ–º (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
if [ "$1" = "--create-file" ]; then
    echo "JWT_SECRET=$SECRET" > .env.jwt
    echo "‚úÖ –ö–ª—é—á —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ .env.jwt"
fi